---
layout: post
title: 日志ETL
permalink: /:categories/plap_user_portrait/
date: 2016-08-04 10:30:15 +0800
category: Milestone
tags: [log, etl]
---

### Flume Interceptor

#### Jar包标准

> 一个jar包，名为sekorm-flume.jar

#### Class标准

##### 统一前缀

> com.sekorm.flume.interceptor.*

##### 标签名等于类名

##### 设计准则

一、完全解耦

> Interceptor之间没有执行先后要求

二、无对外通信

> 对数据流不能有任何阻碍的可能

##### 已有Interceptor

com.sekorm.flume.interceptor.TrashFilter

> 过滤垃圾

com.sekorm.flume.interceptor.InfoDecode

> 解密加密信息

com.sekorm.flume.interceptor.Persona

> 用户画像

#### Dev环境

##### 步骤

1. secureCRT 登录dev环境
2. rz 导入测试新的sekorm-flume.jar, 和 测试用日志文件
3. Flume-loadLog.sh {日志文件名}
4. Flume-loadJar.sh
5. Flume-start.sh
6. 停止运行flume
7. Flume-getLog.sh

##### 脚本列表

###### Flume-loadLog.sh

> 将要测试的日志导入已经监控的文件夹

```bash
# 例子
Flume-loadLog.sh nginx.log
```

###### Flume-loadJar.sh

> 将sekorm-flume.jar包放入flume的载入目录

```bash
# 例子
Flume-loadJar.sh
```

###### Flume-start.sh

> 启动Flume

```bash
# 例子
Flume-start.sh
```

###### Flume-getLog.sh

> 将输出日志导出到根目录

```bash
# 例子
Flume-getLog.sh TrashFilter.log
```
